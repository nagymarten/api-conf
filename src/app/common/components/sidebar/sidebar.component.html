<div class="sidenav">
  <p-toast></p-toast>
  <mat-toolbar color="primary">API Overview</mat-toolbar>

  <mat-accordion>
    <!-- Paths Section -->
    <mat-expansion-panel [expanded]="expandAllPaths" (closed)="onPanelClose()">
      <mat-expansion-panel-header
        (contextmenu)="onPathRightClickHeader($event)"
      >
        <mat-panel-title> <mat-icon>folder</mat-icon> Paths </mat-panel-title>
      </mat-expansion-panel-header>

      <!-- Dynamically render all paths -->
      <mat-list>
        <mat-expansion-panel
          *ngFor="let path of paths | keyvalue"
          [expanded]="true"
        >
          <mat-expansion-panel-header
            (contextmenu)="onPathRightClick($event, path)"
          >
            <mat-panel-title>
              <div *ngIf="editingPath === path.key; else displayPath">
                <input
                  #inputRef
                  type="text"
                  placeholder="users/{user_id}"
                  (blur)="savePath(path.key, $event)"
                  (keyup.enter)="savePath(path.key, $event)"
                  (keyup.escape)="cancelEditPath(path.key)"
                />
              </div>
              <ng-template #displayPath>
                {{ path.key }}
              </ng-template>
            </mat-panel-title>
          </mat-expansion-panel-header>
          <mat-list>
            <mat-list-item
              *ngFor="let method of path.value"
              (contextmenu)="onPathEndpointRightClick($event, method)"
            >
              <a
                [routerLink]="['/path', path.key, method.method]"
                class="method-link"
                routerLinkActive="active-path-method"
              >
                {{ method.method.toUpperCase() }} -
                {{ method.summary || path.key }}
              </a>
            </mat-list-item>
          </mat-list>
        </mat-expansion-panel>
      </mat-list>
    </mat-expansion-panel>

    <mat-expansion-panel>
      <mat-expansion-panel-header
        (contextmenu)="onModelsRightClickHeader($event)"
      >
        <mat-panel-title> <mat-icon>folder</mat-icon> Models </mat-panel-title>
      </mat-expansion-panel-header>

      <mat-list>
        <mat-list-item
          *ngFor="let model of models"
          (contextmenu)="onModelRightClick($event, model)"
        >
          <a
            [routerLink]="['/schemas', model.name]"
            class="method-link"
            routerLinkActive="active-model active-path-method"
          >
            {{ model.name }}
          </a>
        </mat-list-item>
      </mat-list>
    </mat-expansion-panel>

    <p-contextMenu
      #contextHeaderMenu
      [model]="topLevelContextMenuItems"
    ></p-contextMenu>
    <p-contextMenu #contextMenu [model]="contextMenuItems"></p-contextMenu>
    <p-contextMenu
      #pathMethodContextMenu
      [model]="pathEndpointItems"
    ></p-contextMenu>
  </mat-accordion>
</div>
